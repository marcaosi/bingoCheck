<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>BingoCheck</title>
    <link rel="icon" href="favicon.png"/>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">

    <style>
        .row{
            margin: 15px 0;
        }

        .col{
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col">
                <div class="alert alert-success text-center" role="alert" id="msgFinish">
                    
                </div>
                <div class="alert alert-danger text-center" role="alert" id="msgError">
                    
                </div>
                <form action="" id="cartela" onsubmit="fillCart(event)">
                    <div class="row">
                        <div class="col">
                            <h3 class="text-center">B</h3>
                            <input type="text" class="form-control text-center" id="cel11">
                        </div>
                        <div class="col">
                            <h3 class="text-center">I</h3>
                            <input type="text" class="form-control text-center" id="cel12">
                        </div>
                        <div class="col">
                            <h3 class="text-center">N</h3>
                            <input type="text" class="form-control text-center" id="cel13">
                        </div>
                        <div class="col">
                            <h3 class="text-center">G</h3>
                            <input type="text" class="form-control text-center" id="cel14">
                        </div>
                        <div class="col">
                            <h3 class="text-center">O</h3>
                            <input type="text" class="form-control text-center" id="cel15">
                        </div>
                    </div>
                
                    <div class="row">
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel21">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel22">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel23">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel24">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel25">
                        </div>
                    </div>
                
                    <div class="row">
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel31">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel32">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel33" disabled value="X">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel34">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel35">
                        </div>
                    </div>
                
                    <div class="row">
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel41">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel42">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel43">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel44">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel45">
                        </div>
                    </div>
                
                    <div class="row">
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel51">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel52">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel53">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel54">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control text-center" id="cel55">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col text-center">
                            <button type="submit" class="btn btn-success btn-block" id="btnFillCart">Preencher cartela</button>
                        </div>
                    </div>
                </form>

                <div class="row">
                    <div class="col">
                        <input type="text" class="form-control text-center" id="sorteado">&nbsp;
                        <button class="btn btn-success btn-block" onclick="markCel()" disabled id="btnPlay">Jogar</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <h6>Números Sorteados:</h6>
                        <p id="numbers"></p>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <button class="btn btn-light btn-block" onclick="location.reload()">Novo Jogo</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script>

    let cartelaTest = {
        1: 11,
        4: 21,
        7: 31,
        3: 41,
        12: 51,
        16: 12,
        18: 22,
        21: 32,
        24: 42,
        30: 52,
        33: 13,
        38: 23,
        45: 43,
        42: 53,
        50:14,
        58:24,
        47:34,
        49:44,
        55:54,
        61:15,
        66:25,
        69:35,
        72:45,
        75:55
    }

    let keys = Object.keys(cartelaTest)

    keys.forEach(key => {
        let cel = document.getElementById(`cel${cartelaTest[key]}`)
        if(cel != null){
            cel.value = key
        }
    })

    let matriz = {}
    let cartela = {}
    let numbers = ''

    for(let i = 1; i <= 5; ++i){
        matriz[i] = {}
        for(let j = 1; j <= 5; j++){
            matriz[i][j] = 0
            if(i == 3 && j == 3){
                matriz[i][j] = 1
            }
        }
    }

    document.getElementById('msgFinish').style.display = 'none'
    document.getElementById('msgError').style.display = 'none'

    fillCart = event => {

        event.preventDefault()

        let canPlay = true

        for(let i = 1; i <= 5; ++i){
            for(let j = 1; j <= 5; j++){
                
                let cel = document.getElementById(`cel${i}${j}`)

                if(!cel.value){
                    canPlay = false
                }

                if(!(i == 3 && j == 3)){
                    cartela[cel.value] = `${i}${j}`
                }
            }
        }

        let btnPlay = document.getElementById('btnPlay')
        let btnFillCart = document.getElementById('btnFillCart')
        let inputSorteado = document.getElementById('sorteado')
        let msgError = document.getElementById('msgError')
        if(canPlay){
            btnPlay.disabled=false
            btnFillCart.disabled=true
            inputSorteado.focus()
            msgError.style.display = 'none'
        }else{
            msgError.style.display = 'block'
            msgError.textContent = "Você deve preencher a cartela completa para jogar"
        }

    }

    markCel = () => {
        let num = document.getElementById('sorteado')
        let msgFinish = document.getElementById('msgFinish')
        numbers += num.value + ' - '
        
        document.getElementById('numbers').innerHTML = numbers

        let cel = cartela[num.value]

        if(cel != null){
            let posX = cel.charAt(0)
            let posY = cel.charAt(1)
            matriz[posX][posY] = 1
            let inputCel = document.getElementById(`cel${cel}`)
            inputCel.style.borderColor = 'red'

            //verifica se ganhou na linha
            if(verifyLine(posX)){
                colorLine(posX, 'green')
                finishGame()
                msgFinish.textContent = "Você ganhou na linha " + posX
                msgFinish.style.display = 'block'
            }

            //verifica se ganhou na coluna
            if(verifyColumn(posY)){
                colorColumn(posY, 'green')
                finishGame()
                msgFinish.textContent = "Você ganhou na coluna " + posY
                msgFinish.style.display = 'block'
            }

            if(posX == posY){
                // console.log('verifica se ganhou na diagonal principal')
                if(verifyPrimaryDiag()){
                    colorPrimaryDiag('green')
                    finishGame()
                    msgFinish.textContent = "Você ganhou na diagonal principal"
                    msgFinish.style.display = 'block'
                }
                if(posX == '1' || posX == '5'){
                    // console.log('verifica se ganhou nos quatro cantos')
                    if(verifyCorners()){
                        colorCorners('green')
                        finishGame()
                        msgFinish.textContent = "Você ganhou nos quatro cantos"
                        msgFinish.style.display = 'block'
                    }
                }
            }

            if(parseInt(posX) + parseInt(posY) == 6){
                // console.log('verifica diagonal secundaria')
                if(verifySecondaryDiag()){
                    colorSecondaryDiag('green')
                    finishGame()
                    msgFinish.textContent = "Você ganhou na diagonal secundária"
                    msgFinish.style.display = 'block'
                }
                if(posX == '1' || posX == '5'){
                    // console.log('verifica se ganhou nos quatro cantos')
                    if(verifyCorners()){
                        colorCorners('green')
                        finishGame()
                        msgFinish.textContent = "Você ganhou nos quatro cantos"
                        msgFinish.style.display = 'block'
                    }
                }
            }
        }

        num.value = ''
        num.focus()
    }

    finishGame = () => {
        document.getElementById('btnPlay').disabled = true
    }

    colorColumn = (column, color) => {
        for(let i = 1; i <= 5; i++){
            document.getElementById(`cel${i}${column}`).style.borderColor = color
        }
    }

    colorLine = (line, color) => {
        for(let i = 1; i <= 5; i++){
            document.getElementById(`cel${line}${i}`).style.borderColor = color
        }
    }

    colorCorners = (color) => {
        document.getElementById('cel15').style.borderColor = color
        document.getElementById('cel11').style.borderColor = color
        document.getElementById('cel55').style.borderColor = color
        document.getElementById('cel51').style.borderColor = color
    }

    verifyCorners = () => {
        let vencedor = true

        if(matriz[1][5] == 0){
            vencedor = false
        }else if(matriz[1][1] == 0){
            vencedor = false
        }else if(matriz[5][5] == 0){
            vencedor = false
        }else if(matriz[5][1] == 0){
            vencedor = false
        }

        return vencedor
    }

    verifyPrimaryDiag = () => {
        let vencedor = true

        for(let i = 1; i <= 5; i++){
            if(matriz[i][i] == 0){
                vencedor = false;
            }
        }

        return vencedor
    }

    colorPrimaryDiag = (color) => {
        let vencedor = true

        for(let i = 1; i <= 5; i++){
            document.getElementById(`cel${i}${i}`).style.borderColor = color
        }

        return vencedor
    }

    verifySecondaryDiag = () => {
        let vencedor = true

        for(let i = 1; i <= 5; i++){
            if(matriz[i][6-i] == 0){
                vencedor = false;
            }
        }

        return vencedor
    }

    colorSecondaryDiag = (color) => {
        let vencedor = true

        for(let i = 1; i <= 5; i++){
            document.getElementById(`cel${i}${6-i}`).style.borderColor = color
        }

        return vencedor
    }

    verifyLine = (posX) => {
        let vencedor = true
        for(let i = 1; i <= 5; i++){
            if(matriz[posX][i] == 0){
                vencedor = false;
            }
        }
        return vencedor
    }

    verifyColumn = (posY) => {
        let vencedor = true
        for(let i = 1; i <= 5; i++){
            if(matriz[i][posY] == 0){
                vencedor = false;
            }
        }
        return vencedor
    }
</script>

</html>